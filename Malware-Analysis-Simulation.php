<?php

function simulate(array $input): array
{

  $size = count($input);
  $new_array = []; // Inicializar o array para armazenar os indices zerados


  // loop para identificar as posições a zerar 
  for ($index = 0; $index < $size; $index++) {
    $left_pointer = $index - 3;
    $right_pointer = $index + 4;

    if (
      (
        $left_pointer >= 0 && ($input[$left_pointer] >= $input[$index])
      ) ||
      ($right_pointer < $size && ($input[$right_pointer] >= $input[$index]))
    ) {
      $new_array[] = $index;
    }
  }
  $result = array_map(function ($value, $index) use ($new_array) {
    return in_array($index, $new_array) ? 0 : $value;
  }, $input, array_keys($input));

  return $result;
}



$records = [1, 2, 0, 5, 0, 2, 4, 3, 3, 3];
echo implode(', ', simulate($records));
